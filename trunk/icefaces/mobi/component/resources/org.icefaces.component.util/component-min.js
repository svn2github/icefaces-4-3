/*
 * Copyright 2004-2014 ICEsoft Technologies Canada Corp.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the
 * License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an "AS
 * IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 */

if(typeof document!=="undefined"&&!("classList" in document.createElement("a"))){(function(j){if(!("HTMLElement" in j)&&!("Element" in j)){return;}var a="classList",f="prototype",m=(j.HTMLElement||j.Element)[f],b=Object,k=String[f].trim||function(){return this.replace(/^\s+|\s+$/g,"");},c=Array[f].indexOf||function(q){var p=0,o=this.length;for(;p<o;p++){if(p in this&&this[p]===q){return p;}}return -1;},n=function(o,p){this.name=o;this.code=DOMException[o];this.message=p;},g=function(p,o){if(o===""){throw new n("SYNTAX_ERR","An invalid or illegal string was specified");}if(/\s/.test(o)){throw new n("INVALID_CHARACTER_ERR","String contains an invalid character");}return c.call(p,o);},d=function(s){var r=k.call(s.className),q=r?r.split(/\s+/):[],p=0,o=q.length;for(;p<o;p++){this.push(q[p]);}this._updateClassName=function(){s.className=this.toString();};},e=d[f]=[],i=function(){return new d(this);};n[f]=Error[f];e.item=function(o){return this[o]||null;};e.contains=function(o){o+="";return g(this,o)!==-1;};e.add=function(){var s=arguments,r=0,p=s.length,q,o=false;do{q=s[r]+"";if(g(this,q)===-1){this.push(q);o=true;}}while(++r<p);if(o){this._updateClassName();}};e.remove=function(){var t=arguments,s=0,p=t.length,r,o=false;do{r=t[s]+"";var q=g(this,r);if(q!==-1){this.splice(q,1);o=true;}}while(++s<p);if(o){this._updateClassName();}};e.toggle=function(p,q){p+="";var o=this.contains(p),r=o?q!==true&&"remove":q!==false&&"add";if(r){this[r](p);}return !o;};e.toString=function(){return this.join(" ");};if(b.defineProperty){var l={get:i,enumerable:true,configurable:true};try{b.defineProperty(m,a,l);}catch(h){if(h.number===-2146823252){l.enumerable=false;b.defineProperty(m,a,l);}}}else{if(b[f].__defineGetter__){m.__defineGetter__(a,i);}}}(self));}if(!Function.prototype.bind){Function.prototype.bind=function(a){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");}var e=Array.prototype.slice.call(arguments,1),d=this,b=function(){},c=function(){return d.apply(this instanceof b&&a?this:a,e.concat(Array.prototype.slice.call(arguments)));};b.prototype=this.prototype;c.prototype=new b();return c;};}if(!("filter" in Array.prototype)){Array.prototype.filter=function(d,e){var a=[],b;for(var c=0,f=this.length;c<f;c++){if(c in this&&d.call(e,b=this[c],c,this)){a.push(b);}}return a;};}if(!("map" in Array.prototype)){Array.prototype.map=function(d,c){var a=new Array(this.length);for(var b=0,e=this.length;b<e;b++){if(b in this){a[b]=d.call(c,this[b],b,this);}}return a;};}if(!("indexOf" in Array.prototype)){Array.prototype.indexOf=function(b,a){if(a===undefined){a=0;}if(a<0){a+=this.length;}if(a<0){a=0;}for(var c=this.length;a<c;a++){if(a in this&&this[a]===b){return a;}}return -1;};}if(!("lastIndexOf" in Array.prototype)){Array.prototype.lastIndexOf=function(b,a){if(a===undefined){a=this.length-1;}if(a<0){a+=this.length;}if(a>this.length-1){a=this.length-1;}for(a++;a-->0;){if(a in this&&this[a]===b){return a;}}return -1;};}if(!("forEach" in Array.prototype)){Array.prototype.forEach=function(c,b){for(var a=0,d=this.length;a<d;a++){if(a in this){c.call(b,this[a],a,this);}}};}if(!window.ice){window.ice={};}if(!window.ice.mobi){window.ice.mobi={};}if(!window.mobi){window.mobi={};}if(!window.ice.mobi.impl){window.ice.mobi.impl={};}if(!window.console){console={};if(ice.logInContainer){console.log=ice.logInContainer;}else{log=function(){};}}ice.mobi.BUTTON_UNPRESSED=" ui-btn-up-c";ice.mobi.BUTTON_PRESSED=" ui-btn-down-c";mobi.BEHAVIOR_EVENT_PARAM="javax.faces.behavior.event";mobi.PARTIAL_EVENT_PARAM="javax.faces.partial.event";ice.mobi.swapClasses=function(b,e,c){if(!b.className){b.className=c;}else{if(ice.mobi.hasClass(b,e)){var d=b.className;var a=d.replace(e,c);if(d!==a){b.className=a;}}}};ice.mobi.ready=function(a){if(document.addEventListener){document.addEventListener("DOMContentLoaded",a,false);}else{window.attachEvent("onload",a);}};ice.mobi.escapeJsfId=function(a){return a.replace(/:/g,"\\:");};ice.mobi.addListener=function(b,a,c){if(b.addEventListener){b.addEventListener(a,c,false);}else{if(b.attachEvent){b.attachEvent("on"+a,c);}else{ice.log.debug(ice.log,"WARNING:- this browser does not support addEventListener or attachEvent");}}};ice.mobi.removeListener=function(b,a,c){if(b.addEventListener){b.removeEventListener(a,c,false);}else{if(b.attachEvent){b.detachEvent("on"+a,c);}else{ice.log.debug(ice.log,"WARNING cannot remove listener for event="+a+" node="+b);}}};ice.mobi.hasClass=function(a,b){return a.className.replace(/(?:^|\s)remove_cls(?!\S)/,"");};mobi.findForm=function(b){if(!b){console.log("source cannot be null to find form for ajax submit");return null;}var a=document.getElementById(b);while(a.nodeName.toLowerCase()!="form"&&a.parentNode){a=a.parentNode;}ice.log.debug(ice.log,"parent form node ="+a.name);return a;};ice.formOf=function formOf(a){var b=a;while(null!=b){if("form"==b.nodeName.toLowerCase()){return b;}b=b.parentNode;}};ice.mobi.findFormFromNode=function(b){if(!b){console.log("source cannot be null to find form for ajax submit");return null;}var a=b;while(a.nodeName.toLowerCase()!="form"&&a.parentNode){a=a.parentNode;}return a;};ice.mobi.matches=function(c,a){var b=c.webkitMatchesSelector||c.msMatchesSelector||c.mozMatchesSelector;if(b&&b.bind){return(b.bind(c))(a);}else{return Array.prototype.indexOf.call(document.querySelectorAll(a),c)>-1;}};mobi.AjaxRequest=function(b){if(b.onstart&&!b.onstart.call(this,b)){return;}var c=mobi.findForm(b.source);var e=(typeof b.source=="string")?document.getElementById(b.source):b.source;if(!e){if(b.node){e=b.node;e.id=b.source;}}if(c.length==0){c=e.form;ice.log.debug(ice.log,"had to find form via element form length = "+c.length);}if(c.length==0){c=document.forms[0];ice.log.debug(ice.log,"had to find first form on page");}var d=b.execute||"@all";var a=b.render||"@all";ice.fullSubmit(d,a,null,e||c[0],function(i){if(b.event){i(mobi.BEHAVIOR_EVENT_PARAM,b.event);var f=b.event;if(b.event=="valueChange"){f="change";}else{if(b.event=="action"){f="click";}}i(mobi.PARTIAL_EVENT_PARAM,f);}else{i(b.source,b.source);}if(b.params){var g=b.params;for(var h in g){i(h,g[h]);}}},function(k,h,j,g,f){var i={};j(function(l){if(b.onsuccess&&!b.onsuccess.call(i,l,null,null)){return;}});if(b.oncomplete){j(function(l){b.oncomplete.call(i,null,null,i.args);});}if(b.onerror){g(function(l,m){b.onerror.call(i,null,l,m);});f(function(l,m){b.onerror.call(i,null,l,m);});}});};ice.mobi.extendAjaxArguments=function(a,n){a=ice.mobi.clone(a);var g=n.params,k=n.execute,c=n.render,e=n.node,b=n.onstart,j=n.onerror,m=n.onsuccess,d=n.oncomplete;if(g){if(a.params){ice.mobi.extend(a.params,g);}else{a.params=g;}}if(k){if(a.execute){a.execute=a.execute+" "+k;}else{a.execute=k;}}if(c){if(a.render){a.render=a.render+" "+c;}else{a.render=c;}}if(e){a.node=e;}if(b){if(a.onstart){var h=a.onstart;a.onstart=function(o){h(o);b(o);};}else{a.onstart=b;}}if(j){if(a.onerror){var f=a.onerror;a.onerror=function(q,o,p){f(q,o,p);j(q,o,p);};}else{a.onerror=j;}}if(m){if(a.onsuccess){var i=a.onsuccess;a.onsuccess=function(q,o,r,p){i(q,o,r,p);m(q,o,r,p);};}else{a.onsuccess=m;}}if(d){if(a.oncomplete){var l=a.oncomplete;a.oncomplete=function(q,o,p){l(q,o,p);d(q,o,p);};}else{a.oncomplete=d;}}return a;};ice.mobi.clone=function(d){if(null==d||"object"!=typeof d){return d;}if(d instanceof Date){var e=new Date();e.setTime(d.getTime());return e;}if(d instanceof Array){var e=[];var b;for(var c=0,b=d.length;c<b;++c){e[c]=ice.mobi.clone(d[c]);}return e;}if(d instanceof Object){var e={};for(var a in d){if(d.hasOwnProperty(a)){e[a]=ice.mobi.clone(d[a]);}}return e;}throw new Error("Unable to copy obj! Its type isn't supported.");};ice.mobi.ab=function(a){mobi.AjaxRequest(a);};ice.mobi.extend=function(a,c){for(var b in c){a[b]=c[b];}};mobi.registerAuxUpload=function(e,d){var b=ice.mobi.impl.getSplashClause();var a="icemobile:c=register&r="+escape(window.location)+"&JSESSIONID="+e+b+"&u="+escape(d);if(window.chrome){window.location.href=a;return;}var c=document.getElementById("auxiframe");if(null==c){c=document.createElement("iframe");c.setAttribute("id","auxiframe");c.setAttribute("style","width:0px; height:0px; border: 0px");c.setAttribute("src",a);document.body.appendChild(c);}};ice.mobi.panelCenter=function(a,k){var b=document.getElementById(a);var g=k.containerElem||null;if(!b){console.log("Element Not Found id="+a);return;}var c=document.getElementById(g);var p;var o;var i=k.width||b.offsetWidth;var j="";var e=k.height||b.offsetHeight;if(k.width){var m=i+"px";j+=" width: "+m+";";}if(k.height){var l=e+"px";j+=" height: "+l+";";}var p;var o;if(c){p=c.offsetWidth;o=c.offsetHeight;}else{p=mobi._windowWidth();o=mobi._windowHeight();}var d=document.body.scrollTop;if(d==0){d=document.documentElement.scrollTop;}if(o>0){var f=" position: absolute;";var h=((p/2)-(i/2))+"px";var n=d+((o/2)-(e/2))+"px";if(o-e>0){j+=f;j+=" top: "+n+";";j+=" left:"+h+";";}else{j+=f;j+=" left:"+h+";";}if(k.style){j+=k.style;}b.setAttribute("style",j);}else{ice.log.debug(ice.log," Containing div or window has no height to autocenter popup of id="+a);}};mobi.panelAutoCenter=function(a){var c=mobi._windowWidth();var g=mobi._windowHeight();var f=document.body.scrollTop;if(f==0){f=document.documentElement.scrollTop;}if(g>0){var e=document.getElementById(a);if(e){var d=e.offsetHeight;var b=e.offsetWidth;if(g-d>0){e.style.position="absolute";e.style.top=f+((g/2)-(d/2))+"px";e.style.left=((c/2)-(b/2))+"px";}else{e.style.position="absolute";e.style.top=0;e.style.left=((c/2)-(b/2))+"px";}}}};mobi._windowHeight=function(){var a=0;if(typeof(window.innerHeight)=="number"){a=window.innerHeight;}else{if(document.documentElement&&document.documentElement.clientHeight){a=document.documentElement.clientHeight;}else{if(document.body&&document.body.clientHeight){a=document.body.clientHeight;}}}return a;};mobi._windowWidth=function(){var a=0;if(typeof(window.innerWidth)=="number"){a=window.innerWidth;}else{if(document.documentElement&&document.documentElement.clientWidth){a=document.documentElement.clientWidth;}else{if(document.body&&document.body.clientWidth){a=document.body.clientWidth;}}}return a;};ice.mobi.serialize=function(b,d){var f=b.elements;var l=f.length;var m=[];var a=function(j,n){var i="";if(m.length>0){i="&";}i+=encodeURIComponent(j)+"="+encodeURIComponent(n);m.push(i);};for(var h=0;h<l;h++){var c=f[h];if(!c.disabled){var k="";if(d){var g=c.getAttribute("data-type");if(g){k=g+"-";}else{k=c.type+"-";}}switch(c.type){case"submit":case"button":case"fieldset":break;case"text":case"password":case"hidden":case"textarea":a(k+c.name,c.value);break;case"select-one":if(c.selectedIndex>=0){a(k+c.name,c.options[c.selectedIndex].value);}break;case"select-multiple":for(var e=0;e<c.options.length;e++){if(c.options[e].selected){a(k+c.name,c.options[e].value);}}break;case"checkbox":case"radio":if(c.checked){a(k+c.name,c.value);}break;default:a(k+c.name,c.value);}}}return m.join("");};function html5getViewState(a){if(!a){throw new Error("jsf.getViewState:  form must be set");}return ice.mobi.serialize(a,false);}function html5handleResponse(a,d){if(null==a.sourceid){return;}var b={};var e=new DOMParser();var c=e.parseFromString(d,"text/xml");b.responseXML=c;jsf.ajax.response(b,a);}function html5submitFunction(g,b,m){var a=b?b.target:g;a=a?a:g;var e=g;while((null!=e)&&("form"!=e.tagName.toLowerCase())){e=e.parentNode;}var f=new FormData(e);var j=e.id;var k=g?g.id:b.target.id;if(m.execute){var i=m.execute.split(" ");if(i.indexOf("@none")<0){if(i.indexOf("@all")<0){m.execute=m.execute.replace("@this",g.id);m.execute=m.execute.replace("@form",e.id);if(i.indexOf(g.name)<0){m.execute=g.name+" "+m.execute;}}else{m.execute="@all";}}}else{m.execute="@all";}if(m.render){var h=m.render.split(" ");if(h.indexOf("@none")<0){if(h.indexOf("@all")<0){m.render=m.render.replace("@this",g.id);m.render=m.render.replace("@form",e.id);}else{m.render="@all";}}}else{m.execute="@all";}f.append("javax.faces.source",k);f.append(a.name,a.value);f.append("javax.faces.partial.execute",m.execute);f.append("javax.faces.partial.render",m.render);f.append("javax.faces.partial.ajax","true");if(b){f.append("javax.faces.partial.event",b.type);}if(m){for(var d in m){if("function"!=typeof(m[d])){f.append(d,m[d]);}}}var c={source:a,sourceid:k,formid:j,element:g,onevent:m.onevent,onerror:m.onerror||function(n){alert("JSF error "+n.source+" "+n.description);}};var l=new XMLHttpRequest();l.open("POST",e.getAttribute("action"));l.setRequestHeader("Faces-Request","partial/ajax");l.onreadystatechange=function(){if((4==l.readyState)&&(200==l.status)){html5handleResponse(c,l.responseText);}};l.send(f);}if(window.addEventListener){window.addEventListener("load",function(){if((undefined!==window.FormData)&&(undefined===window.ice.mobile)&&((undefined===window.clientInformation)||("BlackBerry"!==window.clientInformation.platform)||(navigator.userAgent.indexOf(" Version/6.0")<0))&&(undefined!==window.Worker)){ice.submitFunction=html5submitFunction;}},false);window.addEventListener("pagehide",function(){if(ice.push){ice.log.debug(ice.log,"PAUSING from pagehide");ice.push.connection.pauseConnection();}},false);window.addEventListener("pageshow",function(){if(ice.push){ice.log.debug(ice.log,"RESUMING from pageshow");ice.push.connection.resumeConnection();}},false);window.addEventListener("hashchange",function(){var e=ice.mobi.getDeviceCommand();var c;if(null!=e){var a;var d;var b=true;if(""!=e){c=ice.mobi.unpackDeviceResponse(e);if(c.name){a=c.name;d=c.value;ice.mobi.setInput(a,a,d);b=false;}}if(b){if(window.ice.ajaxRefresh){ice.ajaxRefresh();}}setTimeout(function(){var g=window.location;history.pushState("",document.title,g.pathname+g.search+"#clear-icemobilesx");history.pushState("",document.title,g.pathname+g.search);var f={name:a,value:d};if("!r"===a.substring(0,2)){f.response=d;f.name="";f.value="";}if(ice.mobi.deviceCommandCallback){ice.mobi.deviceCommandCallback(f);ice.mobi.deviceCommandCallback=null;}},1);}},false);}ice.mobi.button={select:function(a,b,g){var h=document.getElementById(a);if(g.pDisabled){return;}var j=h.className;if(ice.mobi.hasClass(h,ice.mobi.BUTTON_UNPRESSED)){var k=h.className.replace("up","down");h.className=k;}else{}if(g.groupId){var c=document.getElementById(g.groupId+"_hidden");if(c){c.value=a;}}var f=g.params||null;var e=g.singleSubmit||false;var d=g.behaviors||null;var b=b||window.event;var i=function(o,m,n){ice.mobi.button.unSelect(a,j);};var l={onsuccess:i,source:a};if(d&&d.click){d.click();}else{if(e){l.execute="@this";}else{l.execute="@all";}if(f!=null){l.params=f;}else{l.params={};}l.render="@all";if(g.pcId){ice.mobi.panelConf.init(g.pcId,a,g,l);return;}if(g.snId){ice.mobi.submitnotify.open(g.snId,a,g,l);return;}else{mobi.AjaxRequest(l);}}},unSelect:function(a,d){var c=document.getElementById(a);if(c){var b=c.className;c.className=b.replace("down","up");}}};ice.mobi.formOf=function(a){var b=a;while(null!=b){if("form"==b.nodeName.toLowerCase()){return b;}b=b.parentNode;}};ice.mobi.getDeviceCommand=function(){var c="#icemobilesx";var a=c.length;var b=""+window.location.hash;if(c===b.substring(0,a)){return b.substring(a+1);}return null;};ice.mobi.sx=function(d,q){var a=String.fromCharCode(38);var b=ice.mobi.formOf(d);var f=b.getAttribute("action");var g=d.getAttribute("data-command");var h=d.getAttribute("data-id");var l=d.getAttribute("data-jsessionid");var m=d.getAttribute("data-ub");if((null==h)||(""==h)){h=d.getAttribute("id");}var p=d.getAttribute("data-params");var i=window.location;var c=i.toString();var o=c.substring(0,c.lastIndexOf("/"))+"/";var r="";if((null!=m)&&(""!=m)){if("."===m){r="ub="+escape(o)+a;}else{r="ub="+escape(m)+a;}}if(!q){q=d.getAttribute("data-posturl");}if(!q){if(0===f.indexOf("/")){q=window.location.origin+f;}else{if((0===f.indexOf("http://"))||(0===f.indexOf("https://"))){q=f;}else{q=o+f;}}}var k=""+window.location;if(""==window.location.hash){var j=k.lastIndexOf("#");if(j>0){k=k.substring(0,j);}k+="#icemobilesx";}if(""!=p){p=r+p;}var n="";if(""!=l){n="&JSESSIONID="+escape(l);}var e="icemobile:c="+escape(g+"?id="+h+a+p)+"&u="+escape(q)+"&r="+escape(k)+n+"&p="+escape(ice.mobi.serialize(b,false));window.location=e;};ice.mobi.impl.getSplashClause=function(){var a="";if(null!=ice.mobi.splashImageURL){var b="i="+escape(ice.mobi.splashImageURL);a="&s="+escape(b);}return a;};ice.mobi.unpackDeviceResponse=function(e){var b={};var h=e.split("&");var a=h.length;for(var d=0;d<a;d++){var c=h[d].indexOf("=");var f=unescape(h[d].substring(0,c));var g=unescape(h[d].substring(c+1));if("!"===f.substring(0,1)){b[f.substring(1)]=g;}else{b.name=f;b.value=g;}}return b;};ice.mobi.invoke=function(a){var c=a.getAttribute("data-command");if(ice[c]){var b=a.getAttribute("data-params");var d=a.getAttribute("data-id");if((null==d)||(""==d)){d=a.getAttribute("id");}ice[c](d,b);}else{ice.mobi.sx(a);}};ice.mobi.setInput=function(g,a,f,h){var d=a+"-hid";var c=document.getElementById(d);if(c){c.setAttribute("value",f);return;}var b=document.getElementById(g);if(!b){return;}var e=document.createElement("input");e.setAttribute("type","hidden");e.setAttribute("id",d);e.setAttribute("name",a);e.setAttribute("value",f);if(h){e.setAttribute("data-type",h);}b.parentNode.insertBefore(e,b);};ice.mobi.storeLocation=function(e,c){if(!c){return;}var a=document.getElementById(e);if(!a){return;}var b=(a.value)?a.value:"";var d=b.split(",");if(4!=d.length){d=new Array(4);}d[0]=c.latitude;d[1]=c.longitude;d[2]=c.altitude;a.value=d.join();};ice.mobi.storeDirection=function(e,a){if(a.webkitCompassAccuracy<=0){return;}var b=document.getElementById(e);if(!b){return;}var c=(b.value)?b.value:"";var d=c.split(",");if(4!=d.length){d=new Array(4);}d[3]=a.webkitCompassHeading;b.value=d.join();};ice.mobi.geolocation={watchId:0,clientId:"",watchLocation:function(a,e,b,d){ice.mobi.geolocation.clientId=a;ice.mobi.geolocation.clearWatch();var c={};if(b>0){c.maximumAge=b*1000;}if(d>0){c.timeout=d*1000;}if(e!="false"){c.enableHighAccuracy=true;}console.log("Launching watchPosition, maxAge: "+c.maximumAge+"(ms), timeout: "+c.timeout+"(ms) highAccuracy: "+c.enableHighAccuracy);ice.mobi.geolocation.watchId=navigator.geolocation.watchPosition(this.successCallback,this.errorCallback,c);ice.mobi.addListener(window,"deviceorientation",ice.mobi.geolocation.orientationCallback);ice.onElementRemove(a,ice.mobi.geolocation.clearWatch);console.log("Lauching positionWatch for client: "+a+" watchId: "+ice.mobi.geolocation.watchId);},getLocation:function(a,e,b,d){ice.mobi.geolocation.clientId=a;ice.mobi.geolocation.clearWatch();var c={};if(b>0){c.maximumAge=b*1000;}if(d>0){c.timeout=d*1000;}if(e!="false"){c.enableHighAccuracy=true;}console.log("Launching getCurrentPosition, maxAge: "+c.maximumAge+"(ms), timeout: "+c.timeout+"(ms) highAccuracy: "+c.enableHighAccuracy);navigator.geolocation.getCurrentPosition(this.successCallback,this.errorCallback,c);ice.mobi.addListener(window,"deviceorientation",ice.mobi.geolocation.orientationCallback);ice.onElementRemove(a,ice.mobi.geolocation.clearWatch);},successCallback:function(b){console.log("Position update for client: "+ice.mobi.geolocation.clientId);try{inputId=ice.mobi.geolocation.clientId+"_locHidden";ice.mobi.storeLocation(inputId,b.coords);}catch(a){console.log("Exception: "+a);}},errorCallback:function(a){console.log("Error in watchPosition, code: "+a.code+" Message: "+a.message);ice.mobi.geolocation.clearWatch();},orientationCallback:function(a){inputId=ice.mobi.geolocation.clientId+"_locHidden";ice.mobi.storeDirection(inputId,a);},clearWatch:function(){if(ice.mobi.geolocation.watchId>0){console.log("Existing positionWatch: "+ice.mobi.geolocation.watchId+" removed");navigator.geolocation.clearWatch(ice.mobi.geolocation.watchId);ice.mobi.geolocation.watchId=0;}window.removeEventListener("deviceorientation",ice.mobi.geolocation.orientationCallback);}};ice.mobi.getStyleSheet=function(a){return Array.prototype.filter.call(document.styleSheets,function(b){return b.title==a;})[0];};ice.mobi.addStyleSheet=function(b,c){var a=document.createElement("style");a.type="text/css";a.rel="stylesheet";a.title=b;document.querySelectorAll(c||"head")[0].appendChild(a);return ice.mobi.getStyleSheet(b);};(function(a){var b="ontouchstart" in document.documentElement,d="i.mobi-dv-si",c="mobi-dv-si";function e(s,l){function f(){if(!window.location.hash){window.scrollTo(0,0);}}if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)){ice.mobi.addListener(window,"load",function(){if(!window.pageYOffset){f();}});ice.mobi.addListener(window,"orientationchange",f);}var H=l,x="#"+a.escapeJsfId(s),q=x+" > .mobi-dv-mst > div > .mobi-dv-body > tbody > tr",M=x+" > .mobi-dv-mst > .mobi-dv-head > thead > tr > th";function g(V){var U=x+" > .mobi-dv-mst > .mobi-dv-foot > tfoot > tr > td",X=q+":first-child",T=x+" > .mobi-dv-det",W=x+" > .mobi-dv-mst > .mobi-dv-head > thead",S=x+" > .mobi-dv-mst > .mobi-dv-foot > tfoot",Y=x+" > .mobi-dv-mst > div";switch(V){case"det":return document.querySelector(T);case"head":return document.querySelector(W);case"foot":return document.querySelector(S);case"body":return document.querySelector(Y);case"elem":return document.getElementById(s);case"headcells":return document.querySelectorAll(M);case"bodyrows":return document.querySelectorAll(q);case"firstrow":return document.querySelector(X);case"footcells":return document.querySelectorAll(U);}}function r(U,T){var S=U;while(S&&S!=document&&!a.matches(S,T)){S=S.parentNode;}return S==document?null:S;}function O(T){var S=T.clientHeight,U=T.parentNode;while(U!=null&&U.scrollHeight==U.clientHeight){U=U.parentNode;}return U;}function i(S){var T=Array.prototype.filter.call(S.children,function(U){return U.nodeName.toLowerCase()=="input"&&U.getAttribute("name")==s+"_active";});return T[0];}function k(){var W=document.querySelector(x+" > .mobi-dv-mst > div > .mobi-dv-body > thead"),U=document.querySelectorAll(x+" > .mobi-dv-mst > div > .mobi-dv-body > thead > tr > th"),Y=document.querySelector(x+" > .mobi-dv-mst > div > .mobi-dv-body > tfoot"),T=document.querySelectorAll(x+" > .mobi-dv-mst > div > .mobi-dv-body > tfoot > tr > td"),ac=g("head"),ae=g("headcells"),ag=g("foot"),ab=g("footcells"),aa=g("body"),V=g("firstrow"),Z=a.getStyleSheet(s+"_colvis");if(!Z){Z=a.addStyleSheet(s+"_colvis",x);}var ad=Array.prototype.filter.call(V.children,function(ai){return ai.nodeName.toLowerCase()=="td";});if(window.getComputedStyle){var af=Array.prototype.map.call(ad,function(aj){var ai=document.defaultView.getComputedStyle(aj,null);return aj.clientWidth-Math.round(parseFloat(ai.paddingLeft))-Math.round(parseFloat(ai.paddingRight));});for(var X=0;X<af.length;X++){if(Z.insertRule){Z.insertRule(x+" ."+ad[X].classList[0]+" { width: "+af[X]+"px; }",0);}}var ah=Array.prototype.map.call(U,function(aj){var ai=document.defaultView.getComputedStyle(aj,null);return aj.clientWidth-Math.round(parseFloat(ai.paddingLeft))-Math.round(parseFloat(ai.paddingRight));});var S=Array.prototype.map.call(T,function(aj){var ai=document.defaultView.getComputedStyle(aj,null);return aj.clientWidth-Math.round(parseFloat(ai.paddingLeft))-Math.round(parseFloat(ai.paddingRight));});for(var X=0;X<ah.length;X++){ae[X].style.width=ah[X]+"px";}if(ab.length>0){for(var X=0;X<S.length;X++){ab[X].style.width=S[X]+"px";}}}if(H.colvispri){B(V.children);}setTimeout(function(){if(W){W.style.display="none";}if(Y){Y.style.display="none";}},50);m(ac,ag,aa);}function B(X){var U=X[0].getBoundingClientRect().left;var T=a.getStyleSheet(s+"_colvis");var S="@media only all {";if(!T){T=a.addStyleSheet(s+"_colvis",x);}var V=H.colvispri.map(function(ab,aa){var Z=H.colvispri.indexOf(aa);return Z>-1?X[Z]:undefined;}).filter(function(Z){return Z!=undefined;});for(var W=0;W<V.length;W++){var Y=Array.prototype.filter.call(V[W].classList,function(Z){if(Z.indexOf("mobi-dv-c")!=-1){return true;}})[0];U+=V[W].clientWidth;S+="th."+Y+", td."+Y;if(W!=(V.length-1)){S+=", ";}if(T.insertRule){T.insertRule("@media screen and (min-width: "+U+"px) { td."+Y+", th."+Y+" { display: table-cell; }}",0);}}S+="{ display:none; }}";if(T.insertRule){T.insertRule(S,0);}}function m(Z,ad,af){var aa=Z?Z:g("head"),ae=ad?ad:g("foot"),Y=af?af:g("body"),W=g("elem");if(!W){return;}var X=W.getBoundingClientRect(),ac=window.innerHeight-X.top,V=aa?aa.clientHeight:0,S=ae?ae.clientHeight:0,ab=ac-V-S-1;if(Q(ab)){Y.style.height=ab+"px";}var T=O(W),U=function(){ab-=(T.scrollHeight-T.clientHeight);if(Q(ab)){if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)){ab+=60;}Y.style.height=ab+"px";}};if(T){U();}}var N={},o=false,n,p;function E(T){var S=T.currentTarget;N[T.targetTouches[0].identifier]=A(S);if(a.matches(S,M+":first-child")){o=true;}T.preventDefault();}function h(V){var X=V.changedTouches[0],S=r(document.elementFromPoint(X.pageX,X.pageY),"th");if(p&&(new Date().getTime()-p<300)){clearTimeout(n);g("body").scrollTop=0;}else{if(S){var T=A(S);if(o&&a.matches(S,M+":last-child")){z();}else{if(T==N[X.identifier]){var U=F;}}n=setTimeout(function(){U(V);},320);}else{var W=g("det").getBoundingClientRect().top;if(X.pageY<W+25){P();}}}p=new Date().getTime();o=false;N[X.identifier]=undefined;}var I={};function J(S){var T=S.delegateTarget;I[S.targetTouches[0].identifier]={i:T.getAttribute("data-index"),y:S.targetTouches[0].pageY,x:S.targetTouches[0].pageX};}function t(U){var V=r(document.elementFromPoint(U.changedTouches[0].pageX,U.changedTouches[0].pageY),"tr"),T=V.getAttribute("data-index"),W=I[U.changedTouches[0].identifier].y-U.changedTouches[0].pageY,S=I[U.changedTouches[0].identifier].x-U.changedTouches[0].pageX;W=W>-25&&W<25;S=S>-25&&W<25;if(T==I[U.changedTouches[0].identifier].i&&W&&S){u(U.delegateTarget);if(U.delegateTarget.classList.contains("ui-state-active")){P();}else{G(U);}}I[U.changedTouches[0].identifier]=null;}function K(){var U=g("headcells");for(var T=0;T<U.length;++T){var S=U[T];if(b){ice.mobi.addListener(S,"touchend",h);ice.mobi.addListener(S,"touchstart",E);}else{ice.mobi.addListener(S,"click",F);}}}function j(){var S=g("elem"),T=function(U){return function(W){var V=r(W.srcElement,"tr");if(V&&a.matches(V,q)){W.delegateTarget=V;U(W);}};};if(b){ice.mobi.addListener(S,"touchend",T(t));ice.mobi.addListener(S,"touchstart",T(J));}else{ice.mobi.addListener(S,"click",T(G));}}function C(U){var T=U.split("|");var W=g("det");for(var V=0;V<T.length;V++){var S=T[V].split("="),X=W.querySelector("[id$="+a.escapeJsfId(S[0])+"]"),U=S[1],Y;switch(U){case"html":X.innerHTML=S[2];break;case"attr":if(S[2]=="checked"){if(S[3]=="true"){X.checked=true;}else{X.checked=false;}}else{X.setAttribute(S[2],S[3]);}break;default:Y="";break;}}}var w=[];function Q(S){return !isNaN(parseFloat(S))&&isFinite(S);}function y(S){return !isNaN(Date.parse(S));}function L(S){return S.className.indexOf("mobi-dv-bool")!=-1;}function v(){var S=g("firstrow");function T(U){var W=S.children[U.index].innerHTML;var V=U.ascending?1:-1;if(Q(W)){return function(Y,X){return(Y.children[U.index].innerHTML-X.children[U.index].innerHTML)*V;};}if(y(W)){return function(Z,Y){var aa=new Date(Z.children[U.index].innerHTML),X=new Date(Y.children[U.index].innerHTML);if(aa>X){return 1*V;}else{if(X>aa){return -1*V;}}return 0;};}if(L(S.children[U.index])){return function(Z,Y){var aa=Z.children[U.index].innerHTML,X=Y.children[U.index].innerHTML;if(aa<X){return 1*V;}else{if(X<aa){return -1*V;}}return 0;};}else{return function(Z,Y){var aa=Z.children[U.index].innerHTML,X=Y.children[U.index].innerHTML;if(aa>X){return 1*V;}else{if(X>aa){return -1*V;}}return 0;};}}return w.map(T).reduceRight(function(V,U){if(V==undefined){return function(X,W){return U(X,W);};}else{return function(X,W){var Y=U(X,W);if(Y!=0){return Y;}else{return V(X,W);}};}});}function A(U){var T=0,S=U;while((S=S.previousSibling)!=null){T++;}return T;}function P(){var S=g("det");S.removeAttribute("data-index");i(S).setAttribute("value","-1");Array.prototype.every.call(g("bodyrows"),function(T){T.classList.remove("ui-state-active");return true;});m();}function z(){w=[];Array.prototype.every.call(g("headcells"),function(V){var U=V.querySelector(d);U.className=c;return true;});var T=g("bodyrows"),S=T[0].parentNode;T=Array.prototype.map.call(T,function(U){return U;}).sort(function(V,U){return V.getAttribute("data-index")-U.getAttribute("data-index");});S.innerHTML="";T.every(function(U){S.appendChild(U);return true;});}function F(T){var U,aa,W=T.target,ad=c+" icon-caret-up",Y=c+" icon-caret-down",ab=W.querySelector(d),V=ab.className;var Z=A(W);aa=V==Y||V==c;ab.className=aa?ad:Y;w=[{ascending:aa,index:Z}];var ac=w.map(function(ae){return ae.index;});Array.prototype.filter.call(g("headcells"),function(ae){return ac.indexOf(A(ae))==-1;}).every(function(af){var ae=af.querySelector(d);ae.className=c;return true;});var S=g("bodyrows");U=Array.prototype.map.call(S,function(ae){return ae;});U=U.sort(v());var X=S[0].parentNode;X.innerHTML="";Array.prototype.every.call(U,function(ae){X.appendChild(ae);return true;});}function u(S){S.style.backgroundColor="#194FDB";S.style.backgroundImage="none";setTimeout(function(){S.style.backgroundColor="";S.style.backgroundImage="";},100);}function G(W){var V=W.delegateTarget.getAttribute("data-index"),U=g("det"),X=i(U);W.delegateTarget.classList.add("ui-state-active");var T=W.delegateTarget.nextElementSibling,Z=function(aa){aa.classList.remove("ui-state-active");};while(T!=null){Z(T);T=T.nextElementSibling;}T=W.delegateTarget.previousElementSibling;while(T!=null){Z(T);T=T.previousElementSibling;}X.setAttribute("value",V);U.setAttribute("data-index",V);if(H.active=="client"){var Y=W.delegateTarget.getAttribute("data-state");C(Y);m();}else{var S={source:s,execute:"@this",render:"@this"};a.ab(S);}}function D(S){H=S;j();K();k();}j();K();setTimeout(k,100);ice.mobi.addListener(window,"resize",function(){if(!R){setTimeout(function(){if(!R){m();}},100);}});var R=false;ice.mobi.addListener(window,"orientationchange",function(){R=true;setTimeout(function(){m();},500);setTimeout(function(){R=false;},2000);});return{update:D};}a.dataView={instances:{},create:function(f,g){if(this.instances[f]){this.instances[f].update(g);}else{this.instances[f]=e(f,g);}return this.instances[f];}};})(ice.mobi);ice.mobi.addListener(document,"touchstart",function(){});(function(){ice.mobi.sizePagePanelsToViewPort=function(){var j=document.documentElement.className.indexOf("desktop")>-1;if(!j){var a=document.querySelectorAll(".mobi-pagePanel"),d=0;while(d<a.length){var f=a[d].querySelectorAll(".mobi-pagePanel-header").length>0;var c=a[d].querySelectorAll(".mobi-pagePanel-header.ui-header-fixed").length>0;var h=a[d].querySelectorAll(".mobi-pagePanel-footer").length>0;var g=a[d].querySelectorAll(".mobi-pagePanel-footer.ui-footer-fixed").length>0;var b=window.innerHeight;if(f&&!c){b-=40;}if(h&&!g){b-=40;}var e=a[d].querySelector(".mobi-pagePanel-body");if(e){e.style.minHeight=""+b+"px";}d++;}}};if(window.innerHeight){window.addEventListener("load",ice.mobi.sizePagePanelsToViewPort);ice.mobi.addListener(window,"orientationchange",ice.mobi.sizePagePanelsToViewPort);ice.mobi.addListener(window,"resize",ice.mobi.sizePagePanelsToViewPort);}}());(function(m){var d=[];var x="horizontal";var l=0;var e=0;var o;var n=100;var y=(function(){var A=window.getComputedStyle(document.documentElement,""),B=(Array.prototype.slice.call(A).join("").match(/-(moz|webkit|ms)-/)||(A.OLink===""&&["","o"]))[1],C=("WebKit|Moz|MS|O").match(new RegExp("("+B+")","i"))[1];return{dom:C,lowercase:B,css:"-"+B+"-",js:B[0].toUpperCase()+B.substr(1)};})();var p=y.lowercase;function s(){var A=document.getElementsByClassName("mobi-vm-view");for(var B=0;B<A.length;B++){var C=A[B].getAttribute("data-selected");if(C=="true"){return A[B].getAttribute("data-view");}}}function z(C){var B=document.getElementsByClassName("mobi-vm-view");for(var D=0;D<B.length;D++){var A=B[D].getAttribute("data-view");if(A==C){return B[D];}}}function q(){var A=document.body||document.documentElement;var D=A.style;var E="transition";if(typeof D[E]=="string"){return true;}var B=["Moz","Webkit","Khtml","O","ms"];E=E.charAt(0).toUpperCase()+E.substr(1);for(var C=0;C<B.length;C++){if(typeof D[B[C]+E]=="string"){return true;}}return false;}function w(A){document.body.setAttribute("data-orient",A);if(A=="portrait"){document.body.classList.remove("landscape");document.body.classList.add("portrait");}else{if(A=="landscape"){document.body.classList.remove("portrait");document.body.classList.add("landscape");}else{document.body.classList.remove("portrait");document.body.classList.remove("landscape");}}setTimeout(scrollTo,100,0,1);}function j(){console.log("refreshViewDimensions()");if((window.innerWidth!=l)||(window.innerHeight!=e)){l=window.innerWidth;e=window.innerHeight;var B=(l<e)?"portrait":"landscape";w(B);}var D=e-45;var E=z(s());if(E.getElementsByClassName("mobi-vm-nav-bar").length>0){D-=40;}var A=E.getElementsByClassName("mobi-vm-view-content")[0];if(A){A.style.height=""+D+"px";console.log("set view content height to "+D);}else{console.error("ice.mobi.viewManager.refreshViewDimensions() cannot find content node for view = "+E.id);}var C=document.getElementsByClassName("mobi-vm-menu")[0];if(C){C.style.height=""+(e-45)+"px";console.log("set menu height to "+(e-45));}else{console.error("ice.mobi.viewManager.refreshViewDimensions() cannot find menu node");}}function a(A){if("horizontal"==x){return[function(C,B){f(B,"translateX("+(A?"-":"")+window.innerWidth+"px)");},function(C,B){f(C,"translateX("+(A?"100%":"-100%")+")");f(B,"translateX(0%)");}];}else{if("vertical"==x){return[function(C,B){f(B,"translateY("+(A?"-":"")+window.innerWidth+"px)");},function(C,B){f(C,"translateY("+(A?"100%":"-100%")+")");f(B,"translateY(0%)");}];}else{if("flip"==x){return[function(C,B){f(B,"rotateY("+(A?"-":"")+"180deg)");},function(C,B){f(C,"rotateY("+(A?"180deg":"-180deg")+")");f(B,"rotateY(0deg)");}];}else{if("fade"==x){return[function(C,B){v(B,"0");},function(C,B){v(C,"0");v(B,"1");}];}else{if("pageturn"==x){return[function(E,D){var C=D.parentNode;C.style.webkitPerspective=1100;C.style.webkitPerspectiveOrigin="50% 50%";var B=document.createElement("div");B.id="_"+E.id;B.style.width="50%";B.style.height="100%";B.style.position="absolute";B.style.top="0px";B.style.right="0px";B.style.webkitTransformStyle="preserve-3d";B.innerHTML=E.innerHTML;B.style.webkitTransform="rotateY(180deg)";D.parentNode.appendChild(B);E.style.display="none";C.style.webkitTransitionProperty="-webkit-transform";C.style.webkitTransitionDuration="1000ms";C.style.webkitTransitionTimingFunction="ease";C.style.webkitTransformOrigin="left";C.style.webkitTransform="rotateY(-180deg)";},function(E,D){var B=document.getElementById("_"+E.id);var C=D.parentNode;C.removeChild(B);C.style.webkitTransform="none";C.style.webkitTransitionProperty="none";C.style.webkitPerspective="none";C.style.webkitPerspectiveOrigin="";}];}}}}}}function u(D,A,C,B){return{prop:D,toStart:A,from:C,toEnd:B};}function c(A,B){if(p){A.style[""+p+"TransitionDuration"]=B;}A.style.transitionDuration=B;}function f(B,A){B.style.transitionDuration=n;if(p){B.style[""+p+"TransitionDuration"]=n;B.style[""+p+"Transform"]=A;}B.style.transform=A;}function v(A,B){A.style.transitionDuration=n;A.style.opacity=B;}function k(A,B){if(p){A.addEventListener(""+p+"TransitionEnd",B,false);}A.addEventListener("transitionEnd",B,false);}function b(A,B){if(p){A.removeEventListener(""+p+"TransitionEnd",B,false);}A.removeEventListener("transitionEnd",B,false);}function i(E,C,A){console.log("updateViews() enter");if(q()){var F=a(A);F[0](E,C);C.setAttribute("data-selected","true");c(C,"");setTimeout(B,n);setTimeout(function(){console.log("transition() for transition supported");F[1](E,C);},0);}else{C.style.left="100%";scrollTo(0,1);C.setAttribute("data-selected","true");var D=100;G();var H=setInterval(G,0);function G(){console.log("transition() for transition unsupported");D-=20;if(D<=0){D=0;clearInterval(H);B();}E.style.left=(A?(100-D):(D-100))+"%";C.style.left=(A?-D:D)+"%";}}function B(){console.log("transitionComplete");if(E){E.removeAttribute("data-selected");}checkTimer=setTimeout(j,0);setTimeout(r,0,C);if(E){b(E,B);}}console.log("updateViews() exit");}function t(D){console.log("refreshBackButton()");var A=document.getElementsByClassName("mobi-vm-header")[0];var C=A.children[1];var B=s();if(C){if(d.length==1){C.style.display="none";return;}else{var E=d[d.length-2];if(E){var F=z(E);if(F){C.style.display="inline";var G=F.getAttribute("data-title");C.innerHTML=G?G:"Back";}}}}}function h(){var A=z(s());t(A);j();}function r(B){console.log("refreshView()");var A=document.getElementsByClassName("mobi-vm-header")[0];var D=A.firstChild;var C=B.getAttribute("data-title");if(C){D.innerHTML=C;}t();}function g(A){return A.getElementsByClassName("mobi-vm-nav-bar").length>0;}m.viewManager={showView:function(A){console.log("showView("+A+") current");var F=s();if(A==F){return;}var C=d.indexOf(A);var B=C!=-1;if(B){d.splice(C);}var E=z(F);var D=z(A);d.push(D.getAttribute("data-view"));if(D&&E){setTimeout(i,0,E,D,B);}else{if(D){D.setAttribute("data-selected","true");}}document.getElementById("mobi_vm_selected").value=A;jsf.ajax.request(o,event,{execute:"@form",render:"@all"});return false;},goBack:function(B){var A=d.slice(-2,-1)[0];if(A!=undefined){m.viewManager.showView(A);}else{console.error("ViewManager.goBack() invalid state history = "+d);}},goToMenu:function(){m.viewManager.showView(menuId);},setState:function(E,D,B){if(B.length<1){console.error("invalid empty history added to ViewManager.setState() aborting");return;}var A=B[B.length-1];x=E;o=D;d=B;if(A!=s()){var C=z(A);if(C){C.setAttribute("data-selected","true");document.getElementById("mobi_vm_selected").value=A;}}h();ice.mobi.addListener(window,"resize",j);ice.mobi.addListener(window,"orientationchange",j);}};}(ice.mobi));